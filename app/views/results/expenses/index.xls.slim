doctype xml

Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
  Styles
    Style ss:ID="s1"
      Font ss:Bold="1"
    Style ss:ID="s2"
      NumberFormat ss:Format="mm/dd/yy hh:mm AM/PM"
    Style ss:ID="s4" ss:Name="Currency"
      NumberFormat ss:Format='"$"#,##0.00'
  Worksheet ss:Name="Event Expenses"

    Table
      Column ss:Width="150"
      Column ss:Width="150"
      Column ss:Width="120"
      Column ss:Width="200"
      Column ss:Width="100"
      Column ss:Width="100"
      Column ss:Width="100"
      Column ss:Width="200"
      Column ss:Width="80"
      Row ss:StyleID="s1"
        Cell
          Data ss:Type="String" CAMPAIGN NAME
        Cell
          Data ss:Type="String" BRAND
        Cell
          Data ss:Type="String" VENUE NAME
        Cell
          Data ss:Type="String" ADDRESS
        Cell
          Data ss:Type="String" DATE
        Cell
          Data ss:Type="String" START DATE
        Cell
          Data ss:Type="String" END DATE
        Cell
          Data ss:Type="String" AMOUNT
        Cell
          Data ss:Type="String" CATEGORY
        Cell
          Data ss:Type="String" REIMBURSABLE
        Cell
          Data ss:Type="String" BILLABLE
        Cell
          Data ss:Type="String" MERCHANT
        Cell
          Data ss:Type="String" DESCRIPTION
        Cell
          Data ss:Type="String" ACTIVE STATE

      - each_collection_item do |event|
        - event.event_expenses.each do |expense|
          - presenter = present(expense, :xls)
          Row
            Cell
              Data ss:Type="String"= event.campaign_name
            Cell
              Data ss:Type="String"= presenter.brand
            Cell
              Data ss:Type="String"= event.place_name
            Cell
              Data ss:Type="String"= presenter.event_address
            Cell ss:StyleID="s2"
              Data ss:Type="DateTime"= presenter.expense_date
            Cell ss:StyleID="s2"
              Data ss:Type="DateTime"= presenter.end_date
            Cell ss:StyleID="s2"
              Data ss:Type="DateTime"= presenter.start_date
            Cell ss:StyleID="s4"
              Data ss:Type="Number"= presenter.amount
            Cell
              Data ss:Type="String"= presenter.category
            Cell
              Data ss:Type="String"= presenter.reimbursable
            Cell
              Data ss:Type="String"= presenter.billable
            Cell
              Data ss:Type="String"= presenter.merchant
            Cell
              Data ss:Type="String"= presenter.description
            Cell
              Data ss:Type="String"= event.status
