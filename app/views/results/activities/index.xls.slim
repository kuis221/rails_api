doctype xml

Workbook xmlns="urn:schemas-microsoft-com:office:spreadsheet" xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet"
  Styles
    Style ss:ID="normal"
      Font ss:Bold="0"
    Style ss:ID="s1"
      Font ss:Bold="1"
    Style ss:ID="s2"
      NumberFormat ss:Format="mm/dd/yy hh:mm AM/PM"
    Style ss:ID="s3" ss:Name="Hyperlink"
      Font ss:Underline="Single" ss:Color="#0000D4"
    Style ss:ID="s4" ss:Name="Currency"
      NumberFormat ss:Format='"$"#,##0.00'
    Style ss:ID="percentage"
      NumberFormat ss:Format="Percent"
    Style ss:ID="s6" ss:Name="ZipCode"
      NumberFormat ss:Format="00000\-0000"
      Alignment ss:Horizontal="Left"
    Style ss:ID="s7"
      NumberFormat ss:Format="mm/dd/yyyy"

  Worksheet ss:Name="Event Data"
    Table
      Column ss:Width="160"
      Column ss:Width="100"
      Column ss:Width="70"
      Column ss:Width="100"
      Column ss:Width="150"
      Column ss:Width="100"
      Column ss:Width="100"
      Column ss:Width="80"
      Column ss:Width="100"
      - custom_fields_to_export_headers.each do |h|
        Column ss:Width="100"
      Row ss:StyleID="s1"
        Cell
          Data ss:Type="String" CAMPAIGN NAME
        Cell
          Data ss:Type="String" USER
        Cell
          Data ss:Type="String" DATE
        Cell
          Data ss:Type="String" ACTIVITY TYPE
        Cell
          Data ss:Type="String" AREAS
        Cell
          Data ss:Type="String" TD LINX CODE
        Cell
          Data ss:Type="String" VENUE NAME
        Cell
          Data ss:Type="String" ADDRESS
        Cell
          Data ss:Type="String" CITY
        Cell
          Data ss:Type="String" STATE
        Cell
          Data ss:Type="String" ZIP
        Cell
          Data ss:Type="String" ACTIVE STATE

        - custom_fields_to_export_headers.each do |h|
          Cell
            Data ss:Type="String"= h

      - each_collection_item do |activity|
        Row
          Cell
            Data ss:Type="String"= activity.campaign_name
          Cell
            Data ss:Type="String"= activity.company_user_full_name
          Cell ss:StyleID="s7"
            Data ss:Type="DateTime"= Timeliness.parse(activity.activity_date.strftime('%Y-%m-%d 00:00:00'), zone: 'UTC').strftime('%FT00:00')
          Cell
            Data ss:Type="String"= activity.activity_type_name
          Cell
            Data ss:Type="String"= area_for_activity(activity)
          Cell
            Data ss:Type="String"= activity.place_td_linx_code
          Cell
            Data ss:Type="String"= activity.place_name
          Cell
            Data ss:Type="String"= strip_tags(event_place_address(activity, false, ', ', ', '))
          Cell
            Data ss:Type="String"= activity.place_city
          Cell
            Data ss:Type="String"= activity.place_state
          Cell ss:StyleID="s6"
            Data ss:Type="String"= activity.place_zipcode
          Cell
            Data ss:Type="String"= activity.status

          - custom_fields_to_export_values(activity).each do |v|
            Cell ss:StyleID=(v ? v[1] : 'normal')
              Data ss:Type=(v ? v[0] : 'String')
                = v[2] if v
